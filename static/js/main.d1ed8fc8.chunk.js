(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1165:function(t,e,i){},1167:function(t,e,i){"use strict";i.r(e);var s=i(80),r=i.n(s),a=i(474),o=i.n(a),n=(i(480),i(35)),h=i(36),c=i(38),l=i(37),d=i(39),u=i(12),y=i.n(u),k=i(23),g=i.n(k),p=g.a.max([window.innerWidth-6,1200]),f=g.a.max([window.innerHeight-6,800]),v=46,m=function(t){return"".concat("https://tscizzle.github.io/ski-game").concat(t)},S=function(t,e,i){return(e-t)*i+t},w=function(t,e){return Math.atan2(Math.sin(t-e),Math.cos(t-e))},x=function(t){var e,i,s=t.scene,r=t.start,a=t.end,o=t.color,n=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),h={x:r.x,y:r.y-n},c=12*Math.sin(Math.PI/3),l=new y.a.Geom.Line(r.x,r.y,h.x,h.y+c),d=new y.a.Geom.Triangle(a.x,a.y,a.x-6,a.y+c,a.x+6,a.y+c),u=a.x-r.x,k=a.y-r.y,g=(e=u,i=k,Math.atan2(e,-i));y.a.Geom.Triangle.RotateAroundPoint(d,a,g),y.a.Geom.Line.RotateAroundPoint(l,r,g);var p=s.add.graphics();return p.setDefaultStyles({lineStyle:{width:3,color:o},fillStyle:{color:o}}),p.fillTriangleShape(d),p.strokeLineShape(l),p},P=function(t){function e(){return Object(n.a)(this,e),Object(c.a)(this,Object(l.a)(e).call(this,"MountainSlope"))}return Object(d.a)(e,t),Object(h.a)(e,[{key:"preload",value:function(){this.load.image("refMarkers",m("/gameAssets/images/racingArrows.png")),this.load.image("skiBody",m("/gameAssets/images/skiBody.png")),this.load.image("leftSki",m("/gameAssets/images/leftSki.png")),this.load.image("rightSki",m("/gameAssets/images/rightSki.png")),this.load.image("snowParticle",m("/gameAssets/images/snowParticle.png")),this.load.image("crashedSkis",m("/gameAssets/images/crashedSkis.png"))}},{key:"create",value:function(){this.slopeSteepness=Math.PI/6,this.slopeDirection=0,this.gravityAccelerationConstant=500,this.previousAngularVelocity=0,this.previousTurnDirection=null,this.previousTiltAmount=0,this.previousTiltDirection=null,this.previousBackCorner=null,this.isCrashed=!1,this.refDistance=g.a.max([p,f])/2+100,this.refMarkers=[this.add.sprite(0,0,"refMarkers"),this.add.sprite(0,this.refDistance,"refMarkers"),this.add.sprite(this.refDistance,0,"refMarkers"),this.add.sprite(this.refDistance,this.refDistance,"refMarkers")],g.a.each(this.refMarkers,function(t){return t.setScale(.75)}),this.skiBody=this.add.sprite(0,0,"skiBody"),this.leftSki=this.add.sprite(-40,0,"leftSki"),this.rightSki=this.add.sprite(40,0,"rightSki"),this.skiPlayer=this.add.container(this.refDistance/2,this.refDistance/2,[this.skiBody,this.leftSki,this.rightSki]),this.skiPlayer.setScale(.25),this.physics.world.enable(this.skiPlayer),this.edgeSnowParticles=this.add.particles("snowParticle"),this.edgeSnowEmitter=this.edgeSnowParticles.createEmitter({radial:!1,lifespan:375,quantity:5,angle:{min:-100,max:-80},blendMode:"ADD",on:!1}),this.cameras.main.setBackgroundColor(16119285),this.cameras.main.startFollow(this.skiPlayer),this.skiTurningCursors=this.input.keyboard.createCursorKeys(),this.skiTiltCursors=this.input.keyboard.addKeys({up:y.a.Input.Keyboard.KeyCodes.W,down:y.a.Input.Keyboard.KeyCodes.S,left:y.a.Input.Keyboard.KeyCodes.A,right:y.a.Input.Keyboard.KeyCodes.D})}},{key:"update",value:function(){this.drawReferenceObjects(),this.isCrashed||(this.controlRotation(),this.controlTilt(),this.storeSkiPlayerValues()),this.drawRotationArrow(),this.drawVelocityArrow();var t={x:0,y:0};if(!this.isCrashed){var e=Math.sin(this.slopeSteepness),i=g.a.isNull(this.previousTiltDirection)?this.slopeDirection:this.skiPlayer.rotation,s=Math.cos(i-this.slopeDirection),r=this.gravityAccelerationConstant*e*s;t={x:Math.sin(i)*r,y:-Math.cos(i)*r}}var a=Math.atan2(this.skiPlayer.body.velocity.x,-this.skiPlayer.body.velocity.y),o=this.skiPlayer.rotation-Math.PI/2,n=this.skiPlayer.rotation+Math.PI/2,h=Math.abs(w(o,a))<Math.abs(w(n,a))?o:n,c=Math.cos(a-h),l=this.skiPlayer.body.speed*c,d=-l*(.1+.9*this.previousTiltAmount),u=Math.sin(h)*d,k=-Math.cos(h)*d,p={x:t.x+u,y:t.y+k};this.skiPlayer.body.setAcceleration(p.x,p.y);var f=1.1*l,v=Math.abs(d),m=v>=100,x=this.edgeSnowEmitter.on;if(m){x||this.edgeSnowEmitter.start();var P=h===o?"left":"right",b="left"===P?this.skiBody.getBottomLeft(null,!0):this.skiBody.getBottomRight(null,!0),M="left"===P?this.skiBody.getTopLeft(null,!0):this.skiBody.getTopRight(null,!0),A=new y.a.Geom.Line(b.x,b.y,M.x,M.y);this.edgeSnowEmitter.setEmitZone({source:A,type:"random"}),this.edgeSnowEmitter.setSpeed(f);var D,T,O,j=200*Math.floor(v/200);if(j>=1e3?(D=0,T=.12,O=10):(D=50*(1-j/1e3),T=S(.05,.12,j/1e3),O=S(5,10,j/1e3)),D!==this.edgeSnowEmitter.frequency&&(this.edgeSnowEmitter.setFrequency(D),this.edgeSnowEmitter.setScale({start:T,end:0}),this.edgeSnowEmitter.setQuantity(O)),this.previousBackCorner){var B=this.add.graphics();B.setDefaultStyles({lineStyle:{width:3,color:13421772}});var C=B.lineBetween(this.previousBackCorner.x,this.previousBackCorner.y,b.x,b.y);this.add.tween({targets:[C],duration:1e3,alpha:0,onComplete:function(){B.destroy()}})}this.previousBackCorner=b,P===this.previousTiltDirection&&this.crash()}else x&&this.edgeSnowEmitter.stop(),this.previousBackCorner=null}},{key:"controlRotation",value:function(){var t=Math.PI/70,e=Math.PI/1e3,i=g.a.min([this.previousAngularVelocity+e,t]);this.skiTurningCursors.left.isDown?("right"!==this.previousTurnDirection?(this.skiPlayer.rotation-=i,this.previousAngularVelocity=i):this.previousAngularVelocity=0,this.previousTurnDirection="left"):this.skiTurningCursors.right.isDown?("left"!==this.previousTurnDirection?(this.skiPlayer.rotation+=i,this.previousAngularVelocity=i):this.previousAngularVelocity=0,this.previousTurnDirection="right"):(this.previousAngularVelocity=0,this.previousTurnDirection=null)}},{key:"controlTilt",value:function(){var t,e=this.previousTiltDirection;this.skiTiltCursors.left.isDown?"right"!==this.previousTiltDirection?(t=g.a.min([this.previousTiltAmount+.05,1]),e="left"):t=g.a.max([this.previousTiltAmount-.05,0]):this.skiTiltCursors.right.isDown&&"left"!==this.previousTiltDirection?(t=g.a.min([this.previousTiltAmount+.05,1]),e="right"):t=g.a.max([this.previousTiltAmount-.05,0]),0===t&&(e=null);var i=1*(1-t)+.8*t;this.leftSki.setScale(i,1),this.rightSki.setScale(i,1),this.previousTiltAmount=t,this.previousTiltDirection=e}},{key:"storeSkiPlayerValues",value:function(){this.storedSkiPlayerPosition={x:this.skiPlayer.x,y:this.skiPlayer.y},this.storedSkiPlayerRotation=this.skiPlayer.rotation,this.storedSkiPlayerVelocity={x:this.skiPlayer.body.velocity.x,y:this.skiPlayer.body.velocity.y},this.storedSkiPlayerSpeed=this.skiPlayer.body.speed}},{key:"drawRotationArrow",value:function(){this.skisFacingArrowGraphics&&this.skisFacingArrowGraphics.destroy();var t=this.scene.get("VectorLegend").vectorInfos.rotation;if(t.on){var e={x:this.storedSkiPlayerPosition.x,y:this.storedSkiPlayerPosition.y},i={x:e.x+120*Math.sin(this.storedSkiPlayerRotation),y:e.y-120*Math.cos(this.storedSkiPlayerRotation)},s=t.color;this.skisFacingArrowGraphics=x({scene:this,start:e,end:i,color:s})}}},{key:"drawVelocityArrow",value:function(){this.velocityArrowGraphics&&this.velocityArrowGraphics.destroy();var t=this.scene.get("VectorLegend").vectorInfos.velocity;if(t.on){var e=250*function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.999;return 1-Math.pow(e,t)}(this.storedSkiPlayerSpeed),i=this.storedSkiPlayerVelocity.x/this.storedSkiPlayerSpeed*e,s=this.storedSkiPlayerVelocity.y/this.storedSkiPlayerSpeed*e,r={x:this.storedSkiPlayerPosition.x,y:this.storedSkiPlayerPosition.y},a={x:r.x+i,y:r.y+s},o=t.color;this.velocityArrowGraphics=x({scene:this,start:r,end:a,color:o})}}},{key:"drawReferenceObjects",value:function(){var t=Math.floor(this.skiPlayer.y/this.refDistance)*this.refDistance,e=Math.floor(this.skiPlayer.x/this.refDistance)*this.refDistance;if(this.refMarkers[0].x!==e||this.refMarkers[0].y!==t){var i=e+this.refDistance,s=t+this.refDistance;this.refMarkers[0].setPosition(e,t),this.refMarkers[1].setPosition(e,s),this.refMarkers[2].setPosition(i,t),this.refMarkers[3].setPosition(i,s)}}},{key:"crash",value:function(){this.isCrashed=!0,this.skiPlayer.body.setVelocity(0),this.skiPlayer.body.setAcceleration(0),this.leftSki.destroy(),this.rightSki.destroy(),this.crashedSkis=this.add.sprite(0,0,"crashedSkis"),this.skiPlayer.add(this.crashedSkis),this.edgeSnowEmitter.setScale({start:1,end:0}),this.edgeSnowEmitter.setAngle({min:0,max:360}),this.edgeSnowEmitter.setLifespan(750),this.edgeSnowEmitter.setSpeed(150),this.edgeSnowEmitter.explode(30,0,0),this.cameras.main.shake(300,.07),this.events.emit("crash")}}]),e}(y.a.Scene),b=function(t){function e(){return Object(n.a)(this,e),Object(c.a)(this,Object(l.a)(e).call(this,{key:"LogoScene",active:!0}))}return Object(d.a)(e,t),Object(h.a)(e,[{key:"preload",value:function(){this.load.image("logo",m("/gameAssets/images/simulatorLogo.png"))}},{key:"create",value:function(){var t=this.add.sprite(15,15,"logo");t.setOrigin(0,0),t.setScale(.5)}}]),e}(y.a.Scene),M=function(t){function e(){var t;return Object(n.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).call(this,{key:"VectorLegend",active:!0}))).itemWidth=100,t.itemHeight=50,t.itemMargin=26,t.itemTitleSize=14,t.vectorsListTitleSize=20,t.legendItemCenter=function(e){return{x:p-v-t.itemWidth/2,y:v+t.vectorsListTitleSize+10+t.itemMargin+(t.itemMargin+t.itemHeight)*e+t.itemHeight/2}},t}return Object(d.a)(e,t),Object(h.a)(e,[{key:"create",value:function(){var t=this;this.boxGraphics={},this.vectorInfos={rotation:{key:"rotation",title:"Ski Tips Pointing",color:3377322,on:!1,idx:0},velocity:{key:"velocity",title:"Velocity",color:3385856,on:!1,idx:1}},g.a.each(this.vectorInfos,function(e){var i=e.key;t.drawLegendItem({key:i})}),this.add.text(p-v,v,"Show Vectors",{color:"#444444",fontSize:"".concat(this.vectorsListTitleSize,"px"),fontStyle:"bold"}).setOrigin(1,0)}},{key:"drawLegendItem",value:function(t){var e=this,i=t.key,s=this.vectorInfos[i],r=this.legendItemCenter(s.idx),a=r.x,o=r.y,n=this.add.graphics();n.setDefaultStyles({fillStyle:{color:14540253}}),n.fillRect(a-this.itemWidth/2,o-this.itemHeight/2,this.itemWidth,this.itemHeight),x({scene:this,start:{x:a-30,y:o+8},end:{x:a+30,y:o-8},color:s.color});var h=this.add.zone(a,o,this.itemWidth,this.itemHeight);h.setInteractive({useHandCursor:!0}),h.on("pointerup",function(){s.on=!s.on,e.drawLegendItemBorder({key:i})});var c="#".concat(s.color.toString(16));this.add.text(a+this.itemWidth/2,o-this.itemHeight/2-this.itemMargin/2,s.title,{color:c,fontSize:"".concat(this.itemTitleSize,"px")}).setOrigin(1,.5)}},{key:"drawLegendItemBorder",value:function(t){var e=t.key,i=this.vectorInfos[e],s=this.legendItemCenter(i.idx),r=s.x,a=s.y;this.boxGraphics[e]&&this.boxGraphics[e].destroy(),this.boxGraphics[e]=this.add.graphics(),this.boxGraphics[e].setDefaultStyles({lineStyle:{width:3,color:i.color}}),i.on&&this.boxGraphics[e].strokeRect(r-this.itemWidth/2,a-this.itemHeight/2,this.itemWidth,this.itemHeight)}}]),e}(y.a.Scene),A=function(t){function e(){return Object(n.a)(this,e),Object(c.a)(this,Object(l.a)(e).call(this,{key:"SkiTiltDisplay",active:!0}))}return Object(d.a)(e,t),Object(h.a)(e,[{key:"preload",value:function(){this.load.image("leftSkiBack",m("/gameAssets/images/leftSkiBack.png")),this.load.image("rightSkiBack",m("/gameAssets/images/rightSkiBack.png"))}},{key:"create",value:function(){var t=p-v-120,e=f-v-55,i=this.add.graphics();i.setDefaultStyles({lineStyle:{width:3,color:7829367},fillStyle:{color:14540253}}),i.fillRect(t-120,e-55,240,110),i.strokeRect(t-120,e-55,240,110),this.leftSki=this.add.sprite(-220,0,"leftSkiBack"),this.rightSki=this.add.sprite(220,0,"rightSkiBack"),this.skis=this.add.container(t,e,[this.leftSki,this.rightSki]),this.skis.setScale(.23),this.add.text(t+120,e-55-5,"Tilt (view from behind skis)",{color:"#555555",fontSize:"16px"}).setOrigin(1,1)}},{key:"update",value:function(){var t=this.scene.get("MountainSlope"),e=t.previousTiltAmount,i=t.previousTiltDirection,s=(0*(1-e)+Math.PI/4*e)*("left"===i?-1:1);this.leftSki.rotation=s,this.rightSki.rotation=s}}]),e}(y.a.Scene),D=function(t){function e(){return Object(n.a)(this,e),Object(c.a)(this,Object(l.a)(e).call(this,{key:"ResetButton",active:!0}))}return Object(d.a)(e,t),Object(h.a)(e,[{key:"create",value:function(){var t=this,e=p/2,i=f-v-80,s=this.add.graphics();s.setDefaultStyles({lineStyle:{width:8,color:4500036},fillStyle:{color:8969608}}),this.scene.get("MountainSlope").events.on("crash",function(){var r=[e-160,i-80,320,160,5];s.strokeRoundedRect.apply(s,r),s.fillRoundedRect.apply(s,r),t.add.text(e,i,"Lift Back Up",{color:"#117711",fontSize:"28px",fontStyle:"bold"}).setOrigin(.5,.5);var a=t.add.zone(e,i,320,160);a.setInteractive({useHandCursor:!0}),a.on("pointerup",function(){g.a.each(t.scene.manager.scenes,function(t){return t.scene.restart()})})})}}]),e}(y.a.Scene),T=(i(1165),function(t){function e(){var t,i;Object(n.a)(this,e);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(i=Object(c.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(r)))).containerId="game-container",i}return Object(d.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){!function(t){var e=t.parent,i={width:p,height:f,scene:[P,b,M,A,D],physics:{default:"arcade"},type:y.a.AUTO,parent:e};new y.a.Game(i)}({parent:this.containerId})}},{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement("div",{id:this.containerId}))}}]),e}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},475:function(t,e,i){t.exports=i(1167)},480:function(t,e,i){}},[[475,2,1]]]);
//# sourceMappingURL=main.d1ed8fc8.chunk.js.map